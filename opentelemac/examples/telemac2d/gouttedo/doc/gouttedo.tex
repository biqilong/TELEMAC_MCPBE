
\chapter{Gouttedo: Gaussian water surface}
%
% - Purpose & Problem description:
%     These first two parts give reader short details about the test case,
%     the physical phenomena involved and specify how the numerical solution will be validated
%
\section{Purpose}
%
To demonstrate that the Telemac-2D solution is not polarised because it can
simulate the circular spreading of a wave. 
Two types of boundary conditions are tested, solid walls and Thompson.
The first case shows that the no-flow
condition is satisfied on solid boundaries and that the solution remains
symmetric after reflection of the circular wave on the boundaries.
The second case shows that Thompson boundary condition in TELEMAC-2D 
make it possible to simulate the propagation of a circular wave out of the domain 
without spurious reflections on the open boundaries.

%
\section{Description of the problem}
%
\subsection{Geometry and mesh}

\begin{figure}[h]
\begin{center}
  \includegraphicsmaybe{[width=0.5\textwidth]}{../img/Mesh.png}
\end{center}
\caption{Mesh}
\label{fig:gouttedo_mesh}
\end{figure}

The domain is square with a size of  20.1~m x 20.1~m with a flat bottom.
The domain is meshed with 8978 triangular elements and 4624 nodes. Triangles
are obtained by dividing rectagular elements on their diagonals. The mean size
of obntained triangles is about 0.3~m (see figure \ref{fig:gouttedo_mesh}).

\subsection{Initial conditions}
The fluid is initially at rest with a Gaussian free surface in the centre of a
square domain (see Figure \ref{fig:gouttedo_init}). Water depth is given by
$ H= 2.4 \left(1.0+exp \left( \frac{-\left[ (x-10)^2+( y-10)^2\right]}{ 4}\right)\right) $

\begin{figure}[H]
\begin{center}
  \includegraphicsmaybe{[width=0.9\textwidth]}{../img/InitialElevation.png}
\end{center}
\caption{Gouttedo case: initial elevation}
\label{fig:gouttedo_init}
\end{figure}

\subsection{boundary conditions}

Two cases are considered:
\begin{itemize}
\item Boundaries are considered as solid walls with perfect slip conditions (condition 2 2 2) 
\item The Thompson scheme is applied for open boundaries (condition 4 4 4).
\end{itemize}

\subsection{Physical parameters}
%
The physical parameters used for this case are the following:
\begin{itemize}
\item Friction: Strickler formula with K = 40
\item Turbulence: Constant viscosity equal to zero (or disactivation of
  diffusion step using the keyword  \textit{DIFFUSION OF VELOCITY =}\textit{
  NO})
\end{itemize}

\subsection{Numerical parameters}
\begin{itemize}
\item Type of advection: centred semi-implicit scheme + SUPG upwinding on
  velocities (2=SUPG)
\item Type of advection:  conservative + modified SUPG on depth (mandatory
  scheme)
\item  Type of element: Linear triangle (P1) for velocities and  Linear
  triangle (P1) for h
\item Solver : GMRES with an accuracy =  10${}^{-4}$
\item Time step : 0.4 sec.
\item Simulation time : 4 sec.
\end{itemize}

\section{Results with solid walls}
%

The wave spreads circularly around the initial water surface peak elevation.
When it reaches the boundaries, reflection
occurs. Interaction between reflected waves issuing from the four walls can be
observed after time 1.8~sec (cf. figure \ref{t2d:gouttedo:walls_evol}).

\begin{figure}[H]
\begin{minipage}[t]{0.50\textwidth}
 \centering
 \includegraphicsmaybe{[width=0.8\textwidth]}{../img/t2d_gouttedo_qua_time0.png}
\end{minipage}%
\begin{minipage}[t]{0.50\textwidth}
 \centering
 \includegraphicsmaybe{[width=0.9\textwidth]}{../img/t2d_gouttedo_qua_time0_3d.png}
\end{minipage}
\begin{minipage}[t]{0.50\textwidth}
 \centering
 \includegraphicsmaybe{[width=0.8\textwidth]}{../img/t2d_gouttedo_qua_time6.png}
\end{minipage}%
\begin{minipage}[t]{0.50\textwidth}
 \centering
 \includegraphicsmaybe{[width=0.9\textwidth]}{../img/t2d_gouttedo_qua_time6_3d.png}
\end{minipage}
\begin{minipage}[t]{0.50\textwidth}
 \centering
 \includegraphicsmaybe{[width=0.8\textwidth]}{../img/t2d_gouttedo_qua_time12.png}
\end{minipage}%
\begin{minipage}[t]{0.50\textwidth}
 \centering
 \includegraphicsmaybe{[width=0.9\textwidth]}{../img/t2d_gouttedo_qua_time12_3d.png}
\end{minipage}
\begin{minipage}[t]{0.50\textwidth}
 \centering
 \includegraphicsmaybe{[width=0.8\textwidth]}{../img/t2d_gouttedo_qua_time18.png}
\end{minipage}%
\begin{minipage}[t]{0.50\textwidth}
 \centering
 \includegraphicsmaybe{[width=0.9\textwidth]}{../img/t2d_gouttedo_qua_time18_3d.png}
\end{minipage}
\caption{Evolution of free surface with Thompson boundary conditions}
\label{t2d:gouttedo:walls_evol}
\end{figure}

\section{Results with Thompson boundary conditions}

The wave spreads circularly around the initial water surface peak elevation.
The velocity field is radial. No reflection occurs on the open boundaries (cf. figure \ref{t2d:gouttedo:thompson_evol}).
The initial volume of water in the domain is $999.784 2000 m^3$ . The volume that left the domain is $27.83 m^3$.
The total volume of water numerically lost is $0.11* 10^{-4} m^3$ , i.e. $0,000001\%$.

\begin{figure}[H]
\begin{minipage}[t]{0.50\textwidth}
 \centering
 \includegraphicsmaybe{[width=0.8\textwidth]}{../img/WaterDepth_t0.png}
\end{minipage}%
\begin{minipage}[t]{0.50\textwidth}
 \centering
 \includegraphicsmaybe{[width=0.9\textwidth]}{../img/WaterDepth_t0_3d.png}
\end{minipage}
\begin{minipage}[t]{0.50\textwidth}
 \centering
 \includegraphicsmaybe{[width=0.8\textwidth]}{../img/WaterDepth_t3.png}
\end{minipage}%
\begin{minipage}[t]{0.50\textwidth}
 \centering
 \includegraphicsmaybe{[width=0.9\textwidth]}{../img/WaterDepth_t3_3d.png}
\end{minipage}
\begin{minipage}[t]{0.50\textwidth}
 \centering
 \includegraphicsmaybe{[width=0.8\textwidth]}{../img/WaterDepth_t6.png}
\end{minipage}%
\begin{minipage}[t]{0.50\textwidth}
 \centering
 \includegraphicsmaybe{[width=0.9\textwidth]}{../img/WaterDepth_t6_3d.png}
\end{minipage}
\begin{minipage}[t]{0.50\textwidth}
 \centering
 \includegraphicsmaybe{[width=0.8\textwidth]}{../img/WaterDepth_t9.png}
\end{minipage}%
\begin{minipage}[t]{0.50\textwidth}
 \centering
 \includegraphicsmaybe{[width=0.9\textwidth]}{../img/WaterDepth_t9_3d.png}
\end{minipage}
\caption{Evolution of free surface with walls boundary conditions}
\label{t2d:gouttedo:thompson_evol}
\end{figure}


Long wave celerity is $4.85 m.s^{-1}$ for $h = 2.40 m$ and $6.86 m.s^{-1}$ for $h = 4.80 m$,
which means the peak of the wave should reach the boundary after $1.46$ to $2$ seconds in the long wave hypothesis.
The computed value is $1.6$ seconds.

\section{ Conclusions}

Even though the mesh is polarised (along the x and y directions and the main
diagonal), the solution is not.
Solid boundaries are treated properly: no biais occurs in the reflected wave and
water mass is conserved.
With Thomson boundary conditions, no parasite reflection waves are visible.











%
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\chapter{Thompson}
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\section{Case description}
%\subsection{Geometry}
%The domain is square with a size of 20.1 m x 20.1 m.
%\subsection{Mesh}
%The domain is meshed with 8978 triangular elements and 4624 nodes.
%The triangles are obtained by dividing rectagular elements along their diagonals.
%The mean size of the obtained triangles is about (see \ref{fig:thompson:mesh}).
%\begin{figure}[H] %Example
%  \centering
%  \includegraphicsmaybe{[width=0.5\textwidth]}{../img/Mesh.png}
%  \caption{Thompson example: sketch of the mesh and the associated boundary conditions, of type ``HUV-T''}\label{fig:thompson:mesh}
%\end{figure}
%\subsection{Initial conditions}
%
%The fluid is initially at rest with a Gaussian free-surface in the center of the square domain
%(see the figure \ref{fig:thompson:initial}). The water depth is given by the equation \eqref{eq:thompson:initialH}.
%\begin{equation}
%  \label{eq:thompson:initialH}
%  H = 2.4 \exp{\dfrac{-[(x-10) + (y-10)]}{4}}
%\end{equation}
%\begin{figure}[H]
%  \centering
%  \textbf{Water depth at the initial time step}\par\medskip
%  \includegraphicsmaybe{[width=0.4\textwidth]}{../img/WaterDepth_t0.png}\\
%  \textbf{Profile of water depth along (0.0;10.0),(20.0;10.0)}\par\medskip
%  \includegraphicsmaybe{[width=0.8\textwidth]}{../img/WaterDepth1d_0.png}
%  \caption{Thompson example: initial conditions.}\label{fig:thompson:initial}
%\end{figure}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\subsection{Boundary conditions}
%The free-surface and velocity components (44) are considered as those of the sea on the boundaries.
%The Thompson scheme is applied for open boundaries (4).
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\subsection{Physical parameters}
%The physical parameters used for this case are:
%\begin{enumerate}
%\item No friction (LAW OF BOTTOM FRICTION set to 0)
%\item Turbulence: Constant viscosity equal to zero (or disactivation of diffusion step usint the keyword DIFFUSION OF VELOCITY = NO)
%\end{enumerate}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\subsection{Numerical parameters}
%\begin{enumerate}
%\item Type of advection: characteristics on velocities (scheme 1)
%\item Type of advection: conservative + modified SUPG on depth (mandatory scheme)
%\item Type of element: quasi-bubble triangle for velocities and linear triangle (P1) for h
%\item Solver: conjugate gradient (solver 1) with an accuracy of 10${}^{-6}$
%\item Time step: 0.04 sec.
%\item Simulation duration: 4 sec.
%\end{enumerate}
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\section{Results}
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\section{Conclusions}
%On this example it can be observed that even though the mesh is polarised
%(along the x and y directions and the main diagonal), the numerical solution is not.
%Reflection onto the open boundaries are avoided through the use of the Thompson scheme for open boundaries
%(keyword OPTION FOR LIQUID BOUNDARIES).
%%\begin{figure}[H] %Example
%%  \centering
%%  \includegraphicsmaybe{[width=0.5\textwidth]}{../img/Mesh.png}\\
%%  \includegraphicsmaybe{[width=0.5\textwidth]}{../img/WaterDepth_tf.png}
%  \caption{Example}\label{t2d:thompson:mesh}
%\end{figure}
%\cite{Hervouet2007} %Temporary to avoid problems with bibtex when bibtex on one Case
%
